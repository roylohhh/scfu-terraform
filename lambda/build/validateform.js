var f=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var A=Object.prototype.hasOwnProperty;var S=(e,r)=>{for(var t in r)f(e,t,{get:r[t],enumerable:!0})},q=(e,r,t,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of N(r))!A.call(e,a)&&a!==t&&f(e,a,{get:()=>r[a],enumerable:!(i=b(r,a))||i.enumerable});return e};var y=e=>q(f({},"__esModule",{value:!0}),e);var Q={};S(Q,{handler:()=>v});module.exports=y(Q);var g=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,m=/^(02|03|04|07|08)\d{8}$/,D=/^(NSW|VIC|QLD|WA|SA|TAS|ACT|NT)$/,F=/^\d{4}$/,c=[37,80,68,70];function x(e){let r=e.split(",")[1]||e,t=Buffer.from(r,"base64");for(let i=0;i<c.length;i++)if(t[i]!==c[i])return!1;return!0}var s=(e,r,t)=>r.test(e)?null:`Invalid ${t}`,P=e=>e?e.length>50?"First Name should not exceed 50 characters.":s(e,/^[a-zA-Z]+$/,"First Name"):"First Name is required.",p=e=>e?e.length>50?"Last Name should not exceed 50 characters.":s(e,/^[a-zA-Z]+$/,"Last Name"):"Last Name is required.",C=e=>{if(!e)return"Date of Birth is required.";let[r,t,i]=e.split("-").map(Number),a=new Date(i,t-1,r),d=new Date,u=new Date(1900,0,1);return a.getFullYear()!==i||a.getMonth()!==t-1||a.getDate()!==r?"Invalid date of birth.":a>=d?"Date of Birth cannot be in the future.":a<u?"Date of Birth cannot be earlier than January 1, 1900.":null},M=e=>e?s(e,g,"Email Address"):"Email Address is required.",G=e=>e?s(e,m,"Phone Number"):"Phone Number is required.",$=e=>e?null:"Street Address is required.",B=e=>e?null:"Suburb is required.",I=e=>e?s(e,D,"State/Territory"):"State/Territory is required.",z=e=>e?s(e,F,"Postcode"):"Postcode is required.",Z=e=>e!==!0&&e!==!1?"Minor status is required.":null,w=(e,r)=>r?e?s(e,/^[a-zA-Z\s]+$/,"Guardian's Name"):"Guardian's Name is required.":null,E=(e,r)=>r?e?s(e,m,"Guardian's Phone Number"):"Guardian's Phone Number is required.":null,L=e=>e?null:"Please select a study group.",O=e=>e?null:"Please select your area of interest in the study.",R=e=>e&&e.length>500?"Health conditions should not exceed 500 characters.":null,T=e=>e!==!0&&e!==!1?"Contact Consent is required.":null,V=e=>e!==!0&&e!==!1?"Media Consent is required.":null,j=e=>e?x(e)?null:"Form must be PDF document.":"Scanned Form is required.",J=e=>!e||e.trim()===""?"Scanned document file name is required.":null,H=e=>!e||e.trim()===""?"Admin id is required.":null,W=e=>!e||e.trim()===""?"Admin first name is required.":null,k=e=>!e||e.trim()===""?"Admin family name is required.":null,v=async e=>{try{if(!e.formData||!e.scannedForm||!e.admin)return console.error("Error: Malformed JSON object"),{status:"failure",errors:"Malformed JSON object"};let r=new Date,t=e.formData,i=e.scannedForm,a=e.admin,d={},u=[{field:"firstName",validate:P},{field:"lastName",validate:p},{field:"dateOfBirth",validate:C},{field:"email",validate:M},{field:"contactNumber",validate:G},{field:"streetAddress",validate:$},{field:"suburb",validate:B},{field:"state",validate:I},{field:"postcode",validate:z},{field:"isMinor",validate:Z},{field:"guardianName",validate:n=>w(n,t.isMinor)},{field:"guardianPhone",validate:n=>E(n,t.isMinor)},{field:"studyGroup",validate:L},{field:"studyInterest",validate:O},{field:"healthConditions",validate:R},{field:"contactConsent",validate:T},{field:"mediaConsent",validate:V}],Y=[{field:"base64Data",validate:j},{field:"fileName",validate:J}],h=[{field:"id",validate:H},{field:"name",validate:W},{field:"familyName",validate:k}];for(let{field:n,validate:o}of u){let l=o(t[n]);l&&(d[n]=l)}for(let{field:n,validate:o}of h){let l=o(a[n]);l&&(d[n]=l)}return Object.keys(d).length>0?{status:"failure",errors:d}:{status:"success",message:"All fields are valid",timeStamp:r}}catch(r){return console.error("Error:",r),{status:"error",message:"Internal server error"}}};module.exports={handler:v};0&&(module.exports={handler});
